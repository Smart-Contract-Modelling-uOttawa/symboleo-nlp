Domain propMgmtDomain
  Owner isA Role with name: String;
  Manager isA Role with name: String;
  Property isAn Asset;
  Advertise isAn Event with agent: Role, property: Property;
  Disburse isAn Event with from: Role, to: Role, amount: String;
  Reimburse isAn Event with from: Role, to: Role, amount: String;
  Notify isAn Event with agent: Role, target: Role, message: String;
  CollectRent isAn Event with agent: Role, property: Property;
  Accounting isAn Event with agent: Role, target: Role, object: String;
  Repair isAn Event with agent: Role, property: Property;
  ProvideInvoice isAn Event with agent: Role, target: Role, object: String;
  LegalProceedingsNecessary isAn Event with property: Property;
  HandleLegalProceedings isAn Event with agent: Role, property: Property;
  ProvideTerminationNotice isAn Event with agent: Role, numDays: Number;

endDomain

Contract PropMgmt( manager: Manager, owner: Owner, var_ad_expenses: String, var_rent_proceeds: String, var_accounting_artifacts: String, var_repair_costs: String, var_days_notice: Number, var_termination_disbursement: String, var_termination_reimbursement: String )

Declarations
  the_property: Property;
  evt_advertise: Advertise with agent := manager, property := the_property;
  evt_reimburse_advertisting: Reimburse with from := owner, to := manager, amount := var_ad_expenses;
  evt_notify_expenses: Notify with agent := manager, target := owner, message := var_ad_expenses;
  evt_collect_rent: CollectRent with agent := manager, property := the_property;
  evt_disburse: Disburse with from := manager, to := owner, amount := var_rent_proceeds;
  evt_accounting: Accounting with agent := manager, target := owner, object := var_accounting_artifacts;
  evt_repair: Repair with agent := manager, property := the_property;
  evt_reimburse_maintenance: Reimburse with from := owner, to := manager, amount := var_repair_costs;
  evt_repair_invoice: ProvideInvoice with agent := manager, target := owner, object := var_repair_costs;
  evt_legal_proceedings_necessary: LegalProceedingsNecessary with property := the_property;
  evt_handle_legal: HandleLegalProceedings with agent := manager, property := the_property;
  evt_provide_termination_notice_owner: ProvideTerminationNotice with agent := owner, numDays := var_days_notice;
  evt_provide_termination_notice_manager: ProvideTerminationNotice with agent := manager, numDays := var_days_notice;
  evt_disburse_termination: Disburse with from := manager, to := owner, amount := var_termination_deisbursement;
  evt_reimburse_termination: Reimburse with from := owner, to := manager, amount := var_termination_reimbursement;

Preconditions

Postconditions

Obligations
  ob_advertise: Obligation(manager, owner, true, Happens(evt_advertise));
  ob_reimburse: Obligation(owner, manager, true, Happens(evt_reimburse_advertisting));
  ob_notify_expense: Obligation(manager, owner, true, Happens(evt_notify_expenses));
  ob_collect_rent: Obligation(manager, owner, true, Happens(evt_collect_rent));
  ob_disbursement: Obligation(manager, owner, true, Happens(evt_disburse));
  ob_accounting: Obligation(manager, owner, true, Happens(evt_accounting));
  ob_repair: Obligation(manager, owner, true, Happens(evt_repair));
  ob_reimburse_maintenance: Obligation(owner, manager, true, Happens(evt_reimburse_maintenance));
  ob_repair_invoice: Obligation(manager, owner, true, Happens(evt_repair_invoice));
  ob_legal_proceedings: Happens(evt_legal_proceedings_necessary) -> Obligation(manager, owner, true, Happens(evt_handle_legal));
  ob_disburse_termination: Happens(Terminated(self)) -> Obligation(manager, owner, true, WhappensBefore(evt_disburse_termination, Date.Add(Terminated(self), 3, days)));
  ob_reimburse_termination: Obligation(owner, manager, true, WhappensBefore(evt_reimburse_termination, Date.Add(Terminated(self), 10, days)));

Surviving Obligations

Powers
  pow_terminate_notice_owner: Happens(evt_provide_termination_notice_owner) -> Power(owner, manager, true, Terminated(self));
  pow_terminate_notice_manager: Happens(evt_provide_termination_notice_manager) -> Power(manager, owner, true, Terminated(self));

Constraints

endContract